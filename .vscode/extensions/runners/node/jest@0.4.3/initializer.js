/*
 * wallaby-core - v1.0.1620
 * https://wallabyjs.com
 * Copyright (c) 2014-2024 Wallaby.js - All Rights Reserved.
 *
 * This source code file is a part of wallaby-core and is a proprietary (closed source) software.

 * IMPORTANT:
 * Wallaby.js is a tool made by software developers for software developers with passion and love for what we do.
 * Pirating the tool is not only illegal and just morally wrong,
 * it is also unfair to other fellow programmers who are using it legally,
 * and very harmful for the tool and its future.
 */
var TestRunner,utils,transform,testRunner,testFiles,testFilesByPath,jestRunnerModulePath,installCommonGlobalsPath,jasmineFrameworkVersion,path=require("path"),fs=require("graceful-fs"),Q=require("q"),tracer=global.$_$tracer,jestInstalled=!1,EVAL_RESULT_VARIABLE="Object.<anonymous>",jestCliPath="jest-cli",transformPath=jestCliPath+"/src/lib/transform",frozenConfig=!1,compactScriptPreprocessor=!1,instrumentedRoot=process.cwd(),inlineSnapshotsSourceFileName="inline_snapshots";global._mergeSetupScript="",global._setupTestFrameworkScriptFile="",process.env.FORCE_COLOR=0,process.env.JEST_WORKER_ID=tracer.workerId;try{var oldRequireResolve,localProjectRoot=path.dirname(global.wallaby._localNodeModules),oldLoader=(!global.wallaby._localNodeModules||process.env.NODE_PATH&&~process.env.NODE_PATH.indexOf(global.wallaby._localNodeModules)||(process.env.NODE_PATH=(process.env.NODE_PATH?process.env.NODE_PATH+path.delimiter:"")+global.wallaby._localNodeModules),require.extensions[".js"]),oldReadFileSync=require("fs").readFileSync,rootPathFromTestingFramework=(require("fs").readFileSync=function(e){var t=e.replace(/\\/g,"/"),o=oldReadFileSync.apply(this,arguments);if(~t.indexOf(inlineSnapshotsSourceFileName)){var n=o.replace("_callee$property$loc$.column","0").replace("const {line, column} = callee.property.loc.start;","const {line, column} = callee.property.loc.start; column = 0;");n===o&&console.warn("Possibly incompatible Jest version (inline_snapshots)"),o=n}else{if(~t.indexOf("jest-jasmine2/build/jasmine/Env.js"))return o=o.replace("oldListenersException = process","oldListenersException = (j$.process || process)").replace("oldListenersRejection = process","oldListenersRejection = (j$.process || process)");~t.indexOf("jest-snapshot/build/utils.js")?o=o.replace("jest-native-write-file","jest-native-write-file_").replace("jest-native-read-file","jest-native-reade-file_"):~t.indexOf("jest-snapshot/build/State.js")&&(o=o.replace("hasSnapshot && this._updateSnapshot === 'all'","hasSnapshot && (!global.$_$tracer._updateNoMoreThanOneSnapshotPerTestFileRun || !pass && (this.updated === 0)) && this._updateSnapshot === 'all'").replace("this._updateSnapshot === 'all' && this._uncheckedKeys.size","this._updateSnapshot === 'all' && (!global.$_$tracer._updateNoMoreThanOneSnapshotPerTestFileRun || (this.updated === 0)) && this._uncheckedKeys.size"))}return o},require.extensions[".js"]=function(e,t){var o,n,r=t.replace(/\\/g,"/");return~r.indexOf("jest-runtime/build/transform")||~r.indexOf("jest-runtime/build/ScriptTransformer")||~r.indexOf("jest-runtime/build/script_transformer")?((n=(o=require("fs").readFileSync(t,"utf8")).replace("const cache = new Map();","const cache = new Map();global._jestRuntimeCache = cache;").replace(/.readFileSync\(\s*filename,\s*'utf8'\s*\)/,".readFileSync(filename, 'utf8')+(filename === global._setupTestFrameworkScriptFile ? global._mergeSetupScript : \"\")"))===o&&console.warn("Possibly incompatible Jest version (jest-runtime/build/transform|ScriptTransformer)"),e._compile(n,t)):~r.indexOf("@jest/transform/build/ScriptTransformer")?((n=(o=require("fs").readFileSync(t,"utf8")).replace("this._cache = projectCache;","this._cache = projectCache;global._jestRuntimeCache = projectCache.transformedFiles;").replace(/.readFileSync\(\s*filename,\s*'utf8'\s*\)/,".readFileSync(filename, 'utf8')+(filename === global._setupTestFrameworkScriptFile ? global._mergeSetupScript : \"\")"))===o&&console.warn("Possibly incompatible Jest version (@jest/transform/build/ScriptTransformer)"),e._compile(n,t)):~r.indexOf("jest-runner/build/index.js")?(n=(o=require("fs").readFileSync(t,"utf8")).replace("process.env.JEST_WORKER_ID = '1';",""),e._compile(n,t)):~r.indexOf("jest-resolve/build/defaultResolver.js")?(n=(o=require("fs").readFileSync(t,"utf8")).replace("const checkedPaths = new Map();","const checkedPaths = new Map(); checkedPaths.get = function(){};"),e._compile(n,t)):~r.indexOf("react-native/jest/assetFileTransformer")?((n=(o=require("fs").readFileSync(t,"utf8")).replace("path.relative(__dirname, filename)",'path.relative(__dirname.replace("'+localProjectRoot+'", "'+process.cwd()+'"), filename)'))===o&&console.warn("Possibly incompatible Jest version (react-native/jest/assetFileTransformer)"),e._compile(n,t)):~r.indexOf("jest-message-util")?(o=require("fs").readFileSync(t,"utf8"),e._compile(o.replace("renderedCallsite + stacktrace",'"" + stacktrace').replace("`${renderedCallsite}\\n${stacktrace}`","stacktrace"),t)):~r.indexOf("buffered_console")||~r.indexOf("Console")?~(o=require("fs").readFileSync(t,"utf8")).indexOf("BufferedConsole")||~o.indexOf("CustomConsole")?e._compile(o.replace("error() {","error() {$_$tracer._error.apply($_$tracer, arguments);").replace("error(firstArg, ...rest) {","error(firstArg, ...rest) {$_$tracer._reportConsoleErrorAsError && $_$tracer._error.apply($_$tracer, arguments);"),t):oldLoader(e,t):~r.indexOf("source-map-support/source-map-support")?(o=require("fs").readFileSync(t,"utf8"),e._compile(o.replace("function mapSourcePosition(position) {",'function mapSourcePosition(position) {if(position && position.source && ~position.source.replace(/\\\\/g, "/").indexOf("vue-jest/lib/process")) return position;').replace("retrieveMapHandlers = originalRetrieveMapHandlers.slice(0);","retrieveMapHandlers = originalRetrieveMapHandlers.slice(0);retrieveSourceMap = handlerExec(retrieveMapHandlers);retrieveFile = handlerExec(retrieveFileHandlers);"),t)):~r.indexOf("ts-jest/dist/utils")?(n=(o=require("fs").readFileSync(t,"utf8")).replace("if (configPath === path.join(getStartDir()",'if (configPath === path.join("'+localProjectRoot+'"'),e._compile(n,t)):~r.indexOf("fast_path.js")?(n=~(o=require("fs").readFileSync(t,"utf8")).indexOf("_path")?o.replace("relativeFilename.indexOf(INDIRECTION_FRAGMENT) === 0","relativeFilename.indexOf(INDIRECTION_FRAGMENT) === 0 || _path().default.isAbsolute(relativeFilename)"):o.replace("relativeFilename.indexOf(INDIRECTION_FRAGMENT) === 0","relativeFilename.indexOf(INDIRECTION_FRAGMENT) === 0 || path().isAbsolute(relativeFilename)"),e._compile(n,t)):~r.indexOf("installCommonGlobals.js")?(n=(o=require("fs").readFileSync(t,"utf8")).replace("(globalObject, globals) {",`(globalObject, globals) {
        if (!globalObject.$_$tracer) {
          if (!globalObject.regeneratorRuntime && global.regeneratorRuntime) {
            globalObject.regeneratorRuntime = global.regeneratorRuntime;
          }
          globalObject.$_$wp = global.$_$wp;
          globalObject.$_$wpe = global.$_$wpe;
          globalObject.$_$w = global.$_$w;
          globalObject.$_$w_ = global.$_$w_;
          globalObject.$_$wf = global.$_$wf;
          globalObject.$_$wv = global.$_$wv;
          globalObject.$_$tracer = global.$_$tracer;
          global.$_$tracer.setEnvGlobal(globalObject);
          globalObject.$_$tracer._jasmineAdapter = new global.$_$tracer.Jasmine2Reporter(global.$_$tracer);
        }
      `),e._compile(n,t)):~r.indexOf("resolve/lib/node-modules-paths.js")?(n=(o=require("fs").readFileSync(t,"utf8")).replace("paths.push(parsed.dir);",`if (parsed.dir === ${JSON.stringify(path.dirname(instrumentedRoot))}) break; paths.push(parsed.dir);`),e._compile(n,t)):oldLoader(e,t)},function(e){return global.wallaby._testFrameworkPath?path.join(path.dirname(global.wallaby._testFrameworkPath),e):e}),findModule=function(e,t,o){try{var n=require(rootPathFromTestingFramework(e+t));return o&&o(e,t,n.default||n),!0}catch(e){return!1}},foundTestRunner=function(e,t,o){jestCliPath=e,TestRunner=o};if(findModule("react-scripts/node_modules/jest-cli","/build/TestRunner",foundTestRunner)||findModule("react-scripts/node_modules/jest-cli","/build/test_scheduler",foundTestRunner)||findModule("react-scripts/node_modules/jest-cli","/build/TestScheduler",foundTestRunner)||findModule("react-scripts/node_modules/jest/node_modules/jest-cli","/build/TestRunner",foundTestRunner)||findModule("react-scripts/node_modules/jest/node_modules/jest-cli","/build/test_scheduler",foundTestRunner)||findModule("react-scripts/node_modules/jest/node_modules/jest-cli","/build/TestScheduler",foundTestRunner)||findModule("jest-cli/node_modules/@jest/core","/build/TestScheduler",foundTestRunner)||findModule("jest/node_modules/jest-cli/node_modules/@jest/core","/build/TestScheduler",foundTestRunner)||findModule("@jest/core","/build/TestScheduler",foundTestRunner)||findModule("jest-cli","/build/TestRunner",foundTestRunner)||findModule("jest-cli","/build/TestScheduler",foundTestRunner)||findModule("jest-cli","/build/test_scheduler",foundTestRunner)||findModule("jest-cli","/src/TestRunner",foundTestRunner)||findModule("jest/node_modules/jest-cli","/build/TestRunner",foundTestRunner)||findModule("jest/node_modules/jest-cli","/build/test_scheduler",foundTestRunner)||findModule("jest/node_modules/jest-cli","/build/TestScheduler",foundTestRunner),!TestRunner)throw new Error("Cannot find Jest test runner");var jestConfigModule,foundJestRunnerModule=function(e){jestRunnerModulePath=e};if(findModule(jestCliPath+"/node_modules/jest-runner","",foundJestRunnerModule)||findModule(path.join(jestCliPath,"../jest-runner"),"",foundJestRunnerModule)||findModule("jest-runner","",foundJestRunnerModule),jestRunnerModulePath){var jestRuntimeDeepPath=jestRunnerModulePath+"/node_modules/jest-runtime",jestRuntimeShallowPath=path.join(jestRunnerModulePath,"../jest-runtime"),removeDirsAboveInstrumentedRootAndAppendLocalNodeModules=function(e){if(!e||!e[0]||!~e[0].indexOf(instrumentedRoot))return e;function t(e){o.push(e),o.push(e.replace(instrumentedRoot,localProjectRoot))}for(var o=[],n=!1,r=path.dirname(e[0]),l=0;l<e.length;l++){var s,i,a=e[l];a&&(s=path.dirname(a),n||(i=r===s,r=path.dirname(s),i?~s.indexOf(instrumentedRoot)&&t(a):n=!0),n)&&t(a)}return o},foundJestResolveNodeModules=function(e,t){function o(e,t){var o,n=(c.apply(this,arguments)||[]).slice(),r=removeDirsAboveInstrumentedRootAndAppendLocalNodeModules(n);if(!(e&&t&&t.paths&&t.paths.length))return r;if(n.length&&n[n.length-1]===t.paths[t.paths.length-1])return r;for(var l={},s=0;s<t.paths.length;s++){var i=t.paths[s];l[i]=!0,~e.indexOf(i)&&(o=!0)}if(!o)return r;var a={},u=[];for(s=r.length-1;0<=s;s--){var d=r[s];l[d]?a[d]||(u.unshift(d),a[d]=!0):u.unshift(d)}return u}var e=e+t,c=(c=require.cache[require.resolve(e)].exports).default||c;o.default=o,require.cache[require.resolve(e)].exports=o};if(!(findModule(jestRuntimeDeepPath+"/node_modules/jest-resolve","/build/node_modules_paths",foundJestResolveNodeModules)||findModule(jestRuntimeDeepPath+"/node_modules/jest-resolve","/build/nodeModulesPaths",foundJestResolveNodeModules)||findModule(path.join(jestRuntimeDeepPath,"../jest-resolve"),"/build/node_modules_paths",foundJestResolveNodeModules)||findModule(path.join(jestRuntimeDeepPath,"../jest-resolve"),"/build/nodeModulesPaths",foundJestResolveNodeModules)||findModule(jestRuntimeShallowPath+"/node_modules/jest-resolve","/build/node_modules_paths",foundJestResolveNodeModules)||findModule(jestRuntimeShallowPath+"/node_modules/jest-resolve","/build/nodeModulesPaths",foundJestResolveNodeModules)||findModule(path.join(jestRuntimeShallowPath,"../jest-resolve"),"/build/node_modules_paths",foundJestResolveNodeModules)||findModule(path.join(jestRuntimeShallowPath,"../jest-resolve"),"/build/nodeModulesPaths",foundJestResolveNodeModules)||findModule(jestRunnerModulePath+"/node_modules/jest-resolve","/build/node_modules_paths",foundJestResolveNodeModules)||findModule(jestRunnerModulePath+"/node_modules/jest-resolve","/build/nodeModulesPaths",foundJestResolveNodeModules)||findModule(path.join(jestRunnerModulePath,"../jest-resolve"),"/build/node_modules_paths",foundJestResolveNodeModules)||findModule(path.join(jestRunnerModulePath,"../jest-resolve"),"/build/nodeModulesPaths",foundJestResolveNodeModules)||findModule("jest-resolve","/build/node_modules_paths",foundJestRunnerModule)||findModule("jest-resolve","/build/nodeModulesPaths",foundJestRunnerModule)))throw new Error("Cannot find node_modules_paths")}var foundNormalizedConfig=function(e,t,o){var n=(utils={normalizeConfig:o}).normalizeConfig;utils.normalizeConfig=function(){var e=n.apply(this,arguments);return utils.cachedNormalizedConfig=e},jestConfigModule=e},patchJestConfig=function(e,t,o){foundNormalizedConfig(e,t,o);var n=(jestConfigModule=(jestConfigModule=require(jestConfigModule)).default||jestConfigModule).normalize;jestConfigModule.normalize=function(){return utils.cachedNormalizedConfig||n.apply(this,arguments)}},foundBaseReporter=(findModule(jestCliPath,"/src/lib/utils",function(e,t,o){utils=o})||findModule(jestCliPath,"/src/config/normalize",foundNormalizedConfig)||(findModule(jestCliPath+"/node_modules/jest-config","/build/normalize",patchJestConfig)||findModule(path.join(jestCliPath,"../jest-config"),"/build/normalize",patchJestConfig)||findModule("jest-config","/build/normalize",patchJestConfig),!jestRunnerModulePath)||findModule(jestRunnerModulePath+"/node_modules/jest-config","/build/normalize",patchJestConfig)||findModule(path.join(jestRunnerModulePath,"../jest-config"),"/build/normalize",patchJestConfig),function(e,t,o){o=o.prototype;o.log=o._write=function(e){console.log(e+"\n")}}),foundDefaultReporter=function(e,t,o){o.prototype._clearWaitingOn=function(){}},foundSummaryReporter=function(e,t,o){o=o.prototype;o.log=o._write=function(e){}},initCommonGlobalsInstall=(findModule(jestCliPath,"/build/reporters/BaseReporter",foundBaseReporter)&&findModule(jestCliPath,"/build/reporters/DefaultReporter",foundDefaultReporter)||findModule(jestCliPath,"/build/reporters/base_reporter",foundBaseReporter),findModule(jestCliPath,"/build/reporters/summary_reporter",foundSummaryReporter),findModule(jestCliPath,"/../reporters/build/base_reporter",foundBaseReporter),findModule(jestCliPath,"/../reporters/build/summary_reporter",foundSummaryReporter),function(e){installCommonGlobalsPath=e});if(!(findModule(jestCliPath+"/src/environments/installCommonGlobals","",initCommonGlobalsInstall)||findModule(jestCliPath+"/node_modules/jest-util/build/install_common_globals","",initCommonGlobalsInstall)||findModule(path.join(jestCliPath+"/../jest-util/build/install_common_globals"),"",initCommonGlobalsInstall)||findModule("jest-util/build/install_common_globals","",initCommonGlobalsInstall)||findModule(jestCliPath+"/node_modules/jest-util/build/installCommonGlobals","",initCommonGlobalsInstall)||findModule(path.join(jestCliPath+"/../jest-util/build/installCommonGlobals"),"",initCommonGlobalsInstall)||findModule("jest-util/build/installCommonGlobals","",initCommonGlobalsInstall)||findModule(jestCliPath+"/node_modules/jest-util/src/installCommonGlobals","",initCommonGlobalsInstall)||findModule("jest-util/src/installCommonGlobals","",initCommonGlobalsInstall)||findModule(jestCliPath+"/node_modules/jest-util/lib/installCommonGlobals","",initCommonGlobalsInstall)||findModule("jest-util/lib/installCommonGlobals","",initCommonGlobalsInstall)))throw new Error("Can not find install_common_globals path");compactScriptPreprocessor=frozenConfig=!TestRunner.prototype._loadConfigDependencies;try{transformPath=jestCliPath+"/src/lib/transform",transform=require(transformPath)}catch(e){}jestInstalled=!0}catch(e){tracer.start(function(){tracer.reportGlobalError("Failed to initialize wallaby jest.\n"+(e.stack||""))}),module.exports={init:function(){return{configure:function(){}}}}}var nodeFs,originalWriteFileSync,jasmineInitializerPath,jasmineInitializerCode,originalInstallCommonGlobals,newInstallCommonGlobals,foundJestUtil,WallabyReporter,replaceProjectDir,replaceProjectDirInAllRelevantConfigValues,configure,initializeTestsByFilePath=function(){testFilesByPath||(testFilesByPath={},global.$_$testFiles.forEach(function(e){testFilesByPath[e.path]=e}))},remapInlineSnapshot=function(e){var t,o,n;e.frame&&(t=testFilesByPath[path.normalize(e.frame.file)])&&(n=t.path,o=t.originalType,n=(n=n&&o?setOriginalFileTypePath(n,o):n).replace(process.cwd(),localProjectRoot),e.frame.file=n,t.lineMap)&&(e.frame.line=tracer._utils.getOriginalLineByGeneratedLine(t.lineMap,e.frame.line,e.frame.column)||e.frame.line,e.frame.column=1)},setOriginalFileTypePath=function(e,t){var o=e.split(".");return 2<=o.length&&(o[o.length-1]=t,e=o.join(".")),e},jasmineVersion=function(e){return!e||e.testRunner&&!~e.testRunner.indexOf("jasmine2")?1:2},sameSession=function(e){return e._wallabySession===global.$_$session},setSession=function(e){e._wallabySession=global.$_$session},JasmineReporter=function(u){var t=u.initialSpecId();this.reportRunnerStarting=function(){},this.reportRunnerResults=function(){global.$_$initialSpecId=t+1},this.reportSpecStarting=function(e){e.id=++t,u.specStart(e.id,e.description),e.results_.time=(new u._Date).getTime()},this.reportSpecResults=function(e){for(var t=u.specEnd(),o=0===e.results_.failedCount,n=e.results_.skipped,r={id:e.id,timeRange:t,name:e.description,suite:[],status:n?"disabled":"executed",time:n?0:(new u._Date).getTime()-e.results_.time,log:[]},l=e.suite;l;)r.suite.unshift(l.description),l=l.parentSuite;if(!o&&!n)for(var s=e.results_.items_,i=0;i<s.length;i++){var a=s[i];a.passed_||(a.showDiff=a.showDiff||"toEqual"===a.matcherName,r.log.push(u.setAssertionData(a,{message:a.message,stack:a.trace&&a.trace.stack?a.trace.stack:u._undefined})))}r.log.length||delete r.log,u.result(r)},this.specFilter=function(e){if(!u.hasSpecFilter())return!0;for(var t=[e.description],o=e.suite;o;)t.unshift(o.description),o=o.parentSuite;return u.specFilter(t)}},Jasmine2Reporter=tracer.Jasmine2Reporter=function(d){function c(){return e!==global.$_$session}var e=global.$_$session,t=d.initialSpecId(),p=[];this.jasmineDone=function(){c()||(global.$_$initialSpecId=t+1)},this.jasmineStarted=function(){c()||d.started({total:"unknown number of"})},this.suiteStarted=function(e){c()||p.push(e.description)},this.suiteDone=function(){c()||p.pop()},this.specStarted=function(e){c()||(e._id=++t,d.specStart(e._id,e.fullName),e._time=(new d._Date).getTime())},this.specDone=function(e){if(!c()){var t=d.specEnd(),o="passed"===e.status,n="disabled"===e.status||"pending"===e.status||"todo"===e.status,r=n?"pending"===e.status?"skipped":"todo"===e.status?"todo":"disabled"===e.status?"disabled":"executed":"executed",l={id:e._id,timeRange:t,name:e.description,suite:p.slice(),status:r,time:n?0:(new d._Date).getTime()-e._time,log:[],testFile:e._testFile};if(!o&&!n)for(var s=e.failedExpectations,i=0;i<s.length;i++){var a,u=s[i];u.error&&(u.message&&0===u.message.indexOf("Error: expect(")&&((a=u.message.split("\n")).shift(),a[0]&&0!==a[0].length||a.shift(),u.message=a.join("\n")),u.error.matcherResult?(u.matcherName=u.error.matcherResult.name,u.actual=u.error.matcherResult.actual,u.expected=u.error.matcherResult.expected):(u.showDiff=u.error.showDiff,u.actual=u.error.actual,u.expected=u.error.expected)),u.showDiff=u.showDiff||"toEqual"===u.matcherName||"toBe"===u.matcherName||"toMatchSnapshot"===u.matcherName||"toMatchInlineSnapshot"===u.matcherName||"toThrowErrorMatchingSnapshot"===u.matcherName,l.log.push(d.setAssertionData(u,{message:u.message,stack:u.stack}))}l.log.length||delete l.log,d.result(l)}}};jestInstalled&&(nodeFs=require("fs"),(originalWriteFileSync=nodeFs.writeFileSync).alreadyReplaced||(nodeFs.writeFileSync=function(e,t,o){try{var n,r;".snap"===path.extname(e)&&0===e.indexOf(global.wallaby.projectCacheDir)&&(n=require("fs-extra"),r=path.join(global.wallaby.localProjectDir,path.relative(global.wallaby.projectCacheDir,e)))&&(n.ensureDirSync(path.dirname(r)),originalWriteFileSync(r,t,o))}catch(e){console.error(e.stack)}return originalWriteFileSync(e,t,o)},nodeFs.writeFileSync.alreadyReplaced=!0),jasmineInitializerPath={1:path.join(__dirname,"jasmineInitializer.js"),2:path.join(__dirname,"jasmine2Initializer.js")},jasmineInitializerCode={1:"\n"+fs.readFileSync(jasmineInitializerPath[1]),2:"\n"+fs.readFileSync(jasmineInitializerPath[2])},utils.runContentWithLocalBindings=function(e,t,o,n){var r,l=+new Date;global.$_$tracer&&global.$_$tracer.isInitialized()&&(r=Object.keys(n),e.global&&e.runSourceText('this["'+EVAL_RESULT_VARIABLE+'"] = function ('+r.join(",")+") {"+t+"\n};",o),t=e.global?e.global[EVAL_RESULT_VARIABLE]:e("(function("+r.join(",")+"){"+t+"\n})",o),e.global&&delete e.global[EVAL_RESULT_VARIABLE],e=r.map(function(e){return n[e]}),t.apply(null,e),r=+new Date,tracer.debugLog("Loaded "+(global.wallaby?o.replace(global.wallaby.localProjectDir,"").replace(global.wallaby.projectCacheDir,""):o)+" in "+(r-l)+" milliseconds"))},utils.readAndPreprocessFileContent=function(t,o){var e=fs.readFileSync(t,"utf8");if("#!"===e.substr(0,2)&&(e=e.replace(/^#!.*/,"")),o.scriptPreprocessor&&!o.preprocessorIgnorePatterns.some(function(e){if(e)return(e=e.test?e:new RegExp(e)).test(t)}))try{e=compactScriptPreprocessor?require(o.scriptPreprocessor).process(e,t,o):require(o.scriptPreprocessor).process(e,t,{},[],o)}catch(e){throw e.message=o.scriptPreprocessor+": "+e.message,e}return global._mergeSetupScript&&o.setupTestFrameworkScriptFile===t&&(e+=global._mergeSetupScript),e},transform&&(require.cache[require.resolve(transformPath)].exports=utils.readAndPreprocessFileContent),installCommonGlobalsPath&&(originalInstallCommonGlobals=(originalInstallCommonGlobals=require.cache[require.resolve(rootPathFromTestingFramework(installCommonGlobalsPath))].exports).default||originalInstallCommonGlobals,(newInstallCommonGlobals=function(e,t){e.$_$tracer||(!e.regeneratorRuntime&&global.regeneratorRuntime&&(e.regeneratorRuntime=global.regeneratorRuntime),e.$_$wp=global.$_$wp,e.$_$wpe=global.$_$wpe,e.$_$w=global.$_$w,e.$_$w_=global.$_$w_,e.$_$wf=global.$_$wf,e.$_$wv=global.$_$wv,e.$_$tracer=global.$_$tracer,global.$_$tracer.setEnvGlobal(e),e.$_$tracer._jasmineAdapter=new(1===jasmineFrameworkVersion?JasmineReporter:Jasmine2Reporter)(global.$_$tracer)),originalInstallCommonGlobals(e,t)}).default=newInstallCommonGlobals,require.cache[require.resolve(rootPathFromTestingFramework(installCommonGlobalsPath))].exports=newInstallCommonGlobals,findModule(jestCliPath+"/node_modules/jest-util","",foundJestUtil=function(e,t,o){o.installCommonGlobals=newInstallCommonGlobals}),findModule(path.join(jestCliPath+"/../jest-util"),"",foundJestUtil),findModule(path.join(installCommonGlobalsPath,"../.."),"",foundJestUtil),findModule("jest-util","",foundJestUtil),findModule("jest-environment-jsdom/node_modules/jest-util","",foundJestUtil),findModule("jest-environment-node/node_modules/jest-util","",foundJestUtil),findModule("jest-config/node_modules/jest-util","",foundJestUtil),findModule("jest-environment-jsdom-thirteen/node_modules/jest-util","",foundJestUtil),jestRunnerModulePath)&&(findModule(jestRunnerModulePath+"/node_modules/jest-util","",foundJestUtil),findModule(path.join(jestRunnerModulePath,"/../jest-util"),"",foundJestUtil)),TestRunner.prototype._loadConfigDependencies=function(){var t,e=this._config;return null===this._configDeps&&(this._configDeps={ModuleLoader:require(e.moduleLoader),testRunner:require(e.testRunner).bind(null)},t=require(e.testEnvironment),this._configDeps.testEnvironment=function(e){e=new t(e);return e.global.$_$wp=global.$_$wp,e.global.$_$wpe=global.$_$wpe,e.global.$_$w=global.$_$w,e.global.$_$wf=global.$_$wf,e.global.$_$tracer=global.$_$tracer,e.global.$_$tracer._jasmineAdapter=new(1===jasmineFrameworkVersion?JasmineReporter:Jasmine2Reporter)(global.$_$tracer),e}),this._configDeps},(WallabyReporter=function(e){this._completeRun=e}).prototype={onRunStart:function(){},onTestStart:function(){},getLastError:function(){return this._error},_setError:function(e){this._error=e},onTestResult:function(e,t){t.testExecError&&sameSession(this)&&(tracer.reportGlobalError(t.testExecError),this._completeRun())},onRunComplete:function(e,t){!tracer.canUpdateSnapshots()&&t&&t.testResults&&t.testResults.forEach&&t.testResults.forEach(e=>{var t;e&&e.snapshot&&e.snapshot.unchecked&&(t=`${e.snapshot.unchecked} snapshot${1<e.snapshot.unchecked?"s":""} obsolete `+(e.snapshot.uncheckedKeys&&"\n\t"+e.snapshot.uncheckedKeys.join("\n\t")||""),tracer.reportGlobalErrorObject({message:t,stack:t+`
    at ${e.testFilePath}:1:0`,snapshot:!0,allowNotMappedStackLines:!0}))}),this._completeRun()},on:function(){},setState:function(){},isInterrupted:function(){return!1},isWatchMode:function(){return!1}},tracer.start(function(){if(!testRunner){var e;try{e=require(path.join(localProjectRoot,"jest.config"))}catch(e){}if(!e)try{e=require(path.join(localProjectRoot,"package.json")).jest}catch(e){}configure(e)}testFilesByPath=void 0;var s=global.$_$session;testRunner.then(function(t){var o,e,n,r,l;s===global.$_$session&&(o=!1,(e=(e=t._config||t._globalConfig).config&&e.config.rootDir?e.config:e).updateSnapshot=tracer.canUpdateSnapshots()?"all":process.env.CI?"none":t._globalConfig?"new":void 0,r=new WallabyReporter(n=function(e){!o&&sameSession({_wallabySession:s})&&(o=!0,tracer.resetEnvGlobal(),tracer.complete(e))}),setSession(r),t.removeReporter&&t.removeReporter(WallabyReporter),t.addReporter&&t.addReporter(r),l=(t.scheduleTests?t.scheduleTests:t.runTests).bind(t),Q.when().then(function(){return!e.globalSetup||require(e.globalSetup)()}).then(function(){return l(t._globalConfig?testFiles.map(function(e){return{context:t._wallabyContext,path:e}}):testFiles,r).then(function(){return Q.when().then(function(){return!e.globalTeardown||require(e.globalTeardown)()})}).then(function(){n()},function(e){e&&console.error(e.stack),n()})}))}).catch(function(e){console.error("Error while trying to initialize jest: "+(e&&e.message||""))})}),replaceProjectDir=function(e){var t;return"[object String]"===Object.prototype.toString.call(e)&&!~e.indexOf("node_modules")&&(t=e.replace(/^\.\//,"<rootDir>/").replace("<rootDir>",global.wallaby.projectCacheDir),~path.normalize(t).indexOf(path.normalize(global.wallaby.projectCacheDir)))?t:e},replaceProjectDirInAllRelevantConfigValues=function(e){for(var t=["moduleNameMapper","moduleDirectories","modulePaths","setupTestFrameworkScriptFile","setupFiles","setupFilesAfterEnv","snapshotSerializers","transform","globalSetup","globalTeardown"],o=0,n=t.length;o<n;o++){var r=t[o],l=e[r];if(l)switch(Object.prototype.toString.call(l)){case"[object Array]":for(var s=0;s<l.length;s++)l[s]=replaceProjectDir(l[s]);break;case"[object Object]":for(var i in l)l.hasOwnProperty(i)&&(l[i]=replaceProjectDir(l[i]));break;case"[object String]":e[r]=replaceProjectDir(l)}}},configure=function(s){delete(s=s||{}).scriptPreprocessor,delete s.testFileExtensions,delete s.testDirectoryName,s.notify=!1,s.bail=!1,s.collectCoverage=!1,s.rootDir=s.rootDir&&path.resolve(localProjectRoot,s.rootDir.replace(process.cwd(),localProjectRoot))||localProjectRoot||process.cwd(),s.name=s.rootDir.replace(/[/\\]|\s/g,"-"),s.cache=!1!==s.cache,s.globals=s.globals||{},s.globals["ts-jest"]=s.globals["ts-jest"]||{},s.globals["ts-jest"].diagnostics=!1,replaceProjectDirInAllRelevantConfigValues(s),foundJestUtil&&s.testEnvironment&&findModule(s.testEnvironment+"/node_modules/jest-util","",foundJestUtil),(s=(s=utils.normalizeConfig(s,{})).config&&s.config.rootDir?s.config:s).options&&s.options.rootDir&&(s=s.options);try{s.testEnvironment=require.resolve("jest-config/node_modules/"+s.testEnvironment)}catch(e){}var o,n,e,r,t,l;if(s.moduleFileExtensions&&s.moduleFileExtensions.length&&(o=[],n=[],s.moduleFileExtensions.forEach(function(e,t){"js"!==e&&"jsx"!==e||(o.unshift(t),n.unshift(e))}),o.forEach(function(e){s.moduleFileExtensions.splice(e,1)}),n.forEach(function(e){s.moduleFileExtensions.unshift(e)})),s.modulePaths&&s.modulePaths.length)for(var i=0;i<s.modulePaths.length;i++){var a=s.modulePaths[i];a&&~a.indexOf(s.rootDir)&&!~a.indexOf(localProjectRoot)&&(s.modulePaths[i]=a.replace(s.rootDir,process.cwd()))}if(jasmineFrameworkVersion=jasmineVersion(s),s.setupTestFrameworkScriptFile?(global._setupTestFrameworkScriptFile=s.setupTestFrameworkScriptFile,global._mergeSetupScript=jasmineInitializerCode[jasmineFrameworkVersion]):s.setupTestFrameworkScriptFile=jasmineInitializerPath[jasmineFrameworkVersion],s.setupFilesAfterEnv&&(delete s.setupTestFrameworkScriptFile,delete global._setupTestFrameworkScriptFile,delete global._mergeSetupScript,s.setupFilesAfterEnv.unshift(jasmineInitializerPath[jasmineFrameworkVersion])),s.maxWorkers=1,s.verbose=!1,s.cwd=process.cwd(),"prettier"===s.prettierPath)try{s.prettierPath=require.resolve(path.join(localProjectRoot,"node_modules/prettier"))}catch(e){}try{function u(e,t,o){r=(l=o).buildHasteMap||l.createHasteContext||l.createContext}findModule(jestCliPath+"/node_modules/jest-runtime","",u)||findModule(path.join(jestCliPath+"/../jest-runtime"),"",u)||findModule("jest-runtime","",u),!jestRunnerModulePath||findModule(jestRunnerModulePath+"/node_modules/jest-runtime","",u)||findModule(path.join(jestRunnerModulePath+"/../jest-runtime"),"",u);var d,c={maxWorkers:1};process.env.NO_WATCHMAN&&(c.watchman=!1),t=!!(e=r(s,c)).then,l.prototype?(d=l.prototype.requireModule)._wallabyReplaced||(d._wallabyReplaced=!0,l.prototype.requireModule=function(e,t,o){var n,r,l,s=d.apply(this,arguments);return e&&~e.replace(/\\/g,"/").indexOf("jest-snapshot")&&("./utils"===t&&s.getSnapshotPath&&!s.getSnapshotPath._replaced?(initializeTestsByFilePath(),n=s.getSnapshotPath,s.getSnapshotPath=function(){var e=arguments[0],t=(testFilesByPath[path.normalize(e)]||{}).originalType;return e&&t&&(e=setOriginalFileTypePath(e,t)),arguments[0]=e,n.apply(this,arguments)},s.getSnapshotPath._replaced=!0):"./snapshot_resolver"!==t&&"./SnapshotResolver"!==t||!s.buildSnapshotResolver||s.buildSnapshotResolver._replaced?t==="./"+inlineSnapshotsSourceFileName&&s.saveInlineSnapshots&&!s.saveInlineSnapshots._replaced&&(initializeTestsByFilePath(),r=s.saveInlineSnapshots,s.saveInlineSnapshots=function(){return arguments[0].forEach(remapInlineSnapshot),r.apply(this,arguments)},s.saveInlineSnapshots._replaced=!0):(initializeTestsByFilePath(),l=s.buildSnapshotResolver,s.buildSnapshotResolver=function(){var e=l.apply(this,arguments),o=e.resolveSnapshotPath;return e.resolveSnapshotPath=function(){var e=arguments[0],t=(testFilesByPath[path.normalize(e)]||{}).originalType;return e&&t&&(e=setOriginalFileTypePath(e,t)),arguments[0]=e,o.apply(this,arguments)},e},s.buildSnapshotResolver._replaced=!0)),s}):console.error("Error while trying to integrate with jest-snapshot")}catch(e){console.error("Error while trying to initialize jest: "+e.message)}4<TestRunner.length&&console.warn("Possibly incompatible Jest version (TestRunner)");testRunner=3<=TestRunner.length&&"TestScheduler"!==TestRunner.name?t?e.then(function(e){return Q.when(new TestRunner(e,s,{runInBand:!0,maxWorkers:1,getTestSummary:function(){return""}}))}):Q.when(new TestRunner(e,s,{runInBand:!0,maxWorkers:1})):t?e.then(function(e){e.moduleMap&&(n=e.moduleMap,(t=n._mocks||n._raw&&n._raw.mocks)?((r=(o=function(n){return"[object Map]"===Object.prototype.toString.call(n)?{forEach:function(o){n.forEach(function(e,t){o(t)})},get:function(e){return n.get(e)},set:function(e,t){n.set(e,t)}}:{forEach:function(e){for(var t in n)e(t)},get:function(e){return n[e]},set:function(e,t){n[e]=t}}})(t)).forEach(function(e){var t,o=r.get(e);o&&"string"==typeof o&&("ts"!==(t=(o=o.split("."))[o.length-1])&&"tsx"!==t||(o[o.length-1]="js"),o=(o=o.join(".")).replace(localProjectRoot,global.wallaby.projectCacheDir),n._raw&&n._raw.rootDir&&(o=path.join(global.wallaby.projectCacheDir,o)),fs.existsSync(o))&&r.set(e,n._raw&&n._raw.rootDir?path.relative(n._raw.rootDir,o):o)}),(t=n._raw&&n._raw.map)&&(l=o(t)).forEach(function(e){var t=l.get(e);if(t)for(var o in t){var n,o=t[o];o&&"string"==typeof o[0]&&o[0]!==path.join(localProjectRoot,"package.json")&&!~o[0].indexOf("node_modules")&&(n=o[0].replace(localProjectRoot,global.wallaby.projectCacheDir),fs.existsSync(n))&&(o[0]=n)}})):console.warn("Failed to process Jest mocks"));var n,r,l,t,o=new TestRunner(s,{runInBand:!0,maxWorkers:1,pattern:{input:""}});return o._wallabyContext=e,Q.when(o)}):Q.when(new TestRunner(s,{runInBand:!0,maxWorkers:1}))},module.exports={init:function(e){var o=global._jestRuntimeCache;return o&&o.forEach(function(e,t){~t.indexOf(global.$_$baseDir)&&o.delete(t)}),testFiles=e,{configure:function(e){testRunner||configure(e)}}}});